<%#= content_for :content_title do "Thanks #{@user.forename.strip}, here's your conveyancing quote" end %>
<%= content_for :javascript do %>
  <script>
    <% # Remove the deselected class as not to confuse anything as it can be toggled %>
    $(document).ready(function() {
      $('.conveyancing-cost__item--deselected').removeClass('conveyancing-cost__item--deselected');
    });

    $(document).on('click', '.conveyancing-cost__toggle', function() {
      let $formId = $('#' + $(this).data('id'));

      $formId.click();

      $(this).addClass('conveyancing-cost__toggle--hidden');
      $(this).siblings().removeClass('conveyancing-cost__toggle--hidden');

      let $closestForm = $(this).closest('form');

      $closestForm.submit();
      $closestForm.parent()
                  .find('.conveyancing-breakdown__sub-total-overview span')
                  .html('<div class="loader" />');

      return false;
    });
  </script>
<% end %>

<%= render partial: "conveyancing_quotes/configurations/#{@location.configuration.style}",
           locals: {
             user: @user,
             service: @service,
             configuration: @location.configuration,
             costs: ConveyancingCalculator.configuration
                                          .additional_costs[current_user.symbolised_location]
                                          .reduce(Hash.new, :merge)
           } %>
